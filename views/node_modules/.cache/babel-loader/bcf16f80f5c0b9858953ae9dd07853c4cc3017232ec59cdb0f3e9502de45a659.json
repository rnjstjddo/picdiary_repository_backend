{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\win10\\\\Desktop\\\\picdiary\\\\views\\\\src\\\\hooks\\\\useCustomLogin.js\",\n  _s = $RefreshSig$();\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { createSearchParams, Navigate, useNavigate } from \"react-router-dom\";\nimport { joinPostAsync, loginPostAsync, logout, logoutGetAsync, forSessionAsync } from \"../slices/loginSlice\";\nimport { removeCookie } from \"../util/cookieUtil\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useCustomLogin = () => {\n  _s();\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const loginState = useSelector(state => state.loginSlice);\n\n  //  console.log(\"loginState -> \", loginState);\n  const isLogin = loginState.email !== \"\" ? true : false;\n  const forSession = async () => {\n    const result = await dispatch(forSessionAsync()); //리듀서함수에서 return값\n    return result;\n  };\n  const doLogin = async loginParam => {\n    const action = await dispatch(loginPostAsync(loginParam));\n    console.log(\"useCustomLogin커스텀훅의 doLogin() 진입후 axios 비동기 후 액션데이터 => \", action.payload);\n    return action.payload;\n  };\n  const doJoin = async joinParam => {\n    const action = await dispatch(joinPostAsync(joinParam));\n    console.log(\"useCustomLogin커스텀훅의 doJoin() 진입후 axios 비동기 후 액션데이터 => \", action.payload);\n    return action.payload; //리듀서로이동\n  };\n  const doLogout = async () => {\n    //    dispatch(logout());\n    dispatch(logoutGetAsync());\n  };\n  const moveToPath = path => {\n    navigate({\n      pathname: path\n    }, {\n      replace: true\n    });\n  };\n  const moveToLogin = () => {\n    navigate({\n      pathname: \"/member/login\"\n    }, {\n      replace: true\n    });\n  };\n  const moveToJoin = () => {\n    navigate({\n      pathname: \"/member/join\"\n    }, {\n      replace: true\n    });\n  };\n  const moveToLoginReturn = () => {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      replace: true,\n      to: \"/member/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 12\n    }, this);\n  };\n\n  //useEffect에서 로그인하지 않아서 에러시\n  const effectException = ex => {\n    console.log(\"useCustomLogin.js effectException 함수 진입 \", ex);\n  };\n\n  //추가\n  const exceptionHandle = ex => {\n    console.log(\"exceptionHandle() \", ex);\n    if (!isLogin) {\n      removeCookie(\"member\");\n      removeCookie(\"accessToken\");\n      return navigate({\n        pathname: \"/login\"\n      }, {\n        replace: true\n      });\n    }\n    if (ex.response && ex.response.data) {\n      const errorMsg = ex.response.data.error;\n      const errorStr = createSearchParams({\n        error: errorMsg\n      }).toString();\n      if (errorMsg === \"REQUIRE_LOGIN\" || errorMsg === \"ERROR_ACCESS_TOKEN\" || ex.response.data.code === 401) {\n        alert(\"로그인이 필요합니다.\");\n        removeCookie(\"member\");\n        removeCookie(\"accessToken\");\n        navigate({\n          pathname: \"/login\",\n          search: errorStr\n        });\n        return;\n      }\n      if (ex.response.data.error === \"ERROR_ACCESSDENIED\") {\n        alert(\"권한이 없습니다.\");\n        removeCookie(\"member\");\n        removeCookie(\"accessToken\");\n        navigate({\n          pathname: \"/login\",\n          search: errorStr\n        });\n        return;\n      }\n    }\n\n    //추가\n    if (ex.name === \"ERR_BAD_RESPONSE\" || ex.code === \"AxiosError\" || ex.code === \"ERR_BAD_RESPONSE\" || ex.message === \"Network Error\") {\n      navigate({\n        pathname: \"/\"\n      }, {\n        replace: true\n      });\n      return;\n    }\n    if (isLogin && ex !== null) {\n      navigate({\n        pathname: \"/\"\n      }, {\n        replace: true\n      });\n      return;\n    }\n  };\n  return {\n    loginState,\n    isLogin,\n    doLogin,\n    doLogout,\n    moveToPath,\n    moveToLogin,\n    moveToLoginReturn,\n    moveToJoin,\n    doJoin,\n    exceptionHandle,\n    //useEffect내에서 jwt에러\n    effectException,\n    //세션생성\n    forSession\n  };\n};\n_s(useCustomLogin, \"0+HCfk0CDcNmGEPqdeQs+JElZz4=\", false, function () {\n  return [useNavigate, useDispatch, useSelector];\n});\nexport default useCustomLogin;","map":{"version":3,"names":["useDispatch","useSelector","createSearchParams","Navigate","useNavigate","joinPostAsync","loginPostAsync","logout","logoutGetAsync","forSessionAsync","removeCookie","jsxDEV","_jsxDEV","useCustomLogin","_s","navigate","dispatch","loginState","state","loginSlice","isLogin","email","forSession","result","doLogin","loginParam","action","console","log","payload","doJoin","joinParam","doLogout","moveToPath","path","pathname","replace","moveToLogin","moveToJoin","moveToLoginReturn","to","fileName","_jsxFileName","lineNumber","columnNumber","effectException","ex","exceptionHandle","response","data","errorMsg","error","errorStr","toString","code","alert","search","name","message"],"sources":["C:/Users/win10/Desktop/picdiary/views/src/hooks/useCustomLogin.js"],"sourcesContent":["import { useDispatch, useSelector } from \"react-redux\";\r\nimport { createSearchParams, Navigate, useNavigate } from \"react-router-dom\";\r\nimport {\r\n  joinPostAsync,\r\n  loginPostAsync,\r\n  logout,\r\n  logoutGetAsync,\r\n  forSessionAsync,\r\n} from \"../slices/loginSlice\";\r\nimport { removeCookie } from \"../util/cookieUtil\";\r\n\r\nconst useCustomLogin = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const loginState = useSelector((state) => state.loginSlice);\r\n\r\n  //  console.log(\"loginState -> \", loginState);\r\n  const isLogin = loginState.email !== \"\" ? true : false;\r\n\r\n  const forSession = async () => {\r\n    const result = await dispatch(forSessionAsync()); //리듀서함수에서 return값\r\n    return result;\r\n  };\r\n\r\n  const doLogin = async (loginParam) => {\r\n    const action = await dispatch(loginPostAsync(loginParam));\r\n    console.log(\r\n      \"useCustomLogin커스텀훅의 doLogin() 진입후 axios 비동기 후 액션데이터 => \",\r\n      action.payload\r\n    );\r\n    return action.payload;\r\n  };\r\n\r\n  const doJoin = async (joinParam) => {\r\n    const action = await dispatch(joinPostAsync(joinParam));\r\n    console.log(\r\n      \"useCustomLogin커스텀훅의 doJoin() 진입후 axios 비동기 후 액션데이터 => \",\r\n      action.payload\r\n    );\r\n    return action.payload; //리듀서로이동\r\n  };\r\n  const doLogout = async () => {\r\n    //    dispatch(logout());\r\n    dispatch(logoutGetAsync());\r\n  };\r\n\r\n  const moveToPath = (path) => {\r\n    navigate({ pathname: path }, { replace: true });\r\n  };\r\n\r\n  const moveToLogin = () => {\r\n    navigate({ pathname: \"/member/login\" }, { replace: true });\r\n  };\r\n\r\n  const moveToJoin = () => {\r\n    navigate({ pathname: \"/member/join\" }, { replace: true });\r\n  };\r\n\r\n  const moveToLoginReturn = () => {\r\n    return <Navigate replace to=\"/member/login\" />;\r\n  };\r\n\r\n  //useEffect에서 로그인하지 않아서 에러시\r\n  const effectException = (ex) => {\r\n    console.log(\"useCustomLogin.js effectException 함수 진입 \", ex);\r\n  };\r\n\r\n  //추가\r\n  const exceptionHandle = (ex) => {\r\n    console.log(\"exceptionHandle() \", ex);\r\n\r\n    if (!isLogin) {\r\n      removeCookie(\"member\");\r\n      removeCookie(\"accessToken\");\r\n\r\n      return navigate({ pathname: \"/login\" }, { replace: true });\r\n    }\r\n\r\n    if (ex.response && ex.response.data) {\r\n      const errorMsg = ex.response.data.error;\r\n\r\n      const errorStr = createSearchParams({ error: errorMsg }).toString();\r\n\r\n      if (\r\n        errorMsg === \"REQUIRE_LOGIN\" ||\r\n        errorMsg === \"ERROR_ACCESS_TOKEN\" ||\r\n        ex.response.data.code === 401\r\n      ) {\r\n        alert(\"로그인이 필요합니다.\");\r\n        removeCookie(\"member\");\r\n        removeCookie(\"accessToken\");\r\n        navigate({ pathname: \"/login\", search: errorStr });\r\n        return;\r\n      }\r\n\r\n      if (ex.response.data.error === \"ERROR_ACCESSDENIED\") {\r\n        alert(\"권한이 없습니다.\");\r\n        removeCookie(\"member\");\r\n        removeCookie(\"accessToken\");\r\n\r\n        navigate({ pathname: \"/login\", search: errorStr });\r\n        return;\r\n      }\r\n    }\r\n\r\n    //추가\r\n    if (\r\n      ex.name === \"ERR_BAD_RESPONSE\" ||\r\n      ex.code === \"AxiosError\" ||\r\n      ex.code === \"ERR_BAD_RESPONSE\" ||\r\n      ex.message === \"Network Error\"\r\n    ) {\r\n      navigate({ pathname: \"/\" }, { replace: true });\r\n      return;\r\n    }\r\n\r\n    if (isLogin && ex !== null) {\r\n      navigate({ pathname: \"/\" }, { replace: true });\r\n      return;\r\n    }\r\n  };\r\n\r\n  return {\r\n    loginState,\r\n    isLogin,\r\n    doLogin,\r\n    doLogout,\r\n    moveToPath,\r\n    moveToLogin,\r\n    moveToLoginReturn,\r\n    moveToJoin,\r\n    doJoin,\r\n    exceptionHandle,\r\n    //useEffect내에서 jwt에러\r\n    effectException,\r\n    //세션생성\r\n    forSession,\r\n  };\r\n};\r\n\r\nexport default useCustomLogin;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}